<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端监控 | lishenjian | Blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.992cb7aa.css" as="style"><link rel="preload" href="/assets/js/app.8ad917e5.js" as="script"><link rel="preload" href="/assets/js/2.eeada228.js" as="script"><link rel="preload" href="/assets/js/10.8a4cc5a5.js" as="script"><link rel="prefetch" href="/assets/js/11.40a06816.js"><link rel="prefetch" href="/assets/js/12.67b17ea9.js"><link rel="prefetch" href="/assets/js/13.420ee93a.js"><link rel="prefetch" href="/assets/js/3.b4adcb99.js"><link rel="prefetch" href="/assets/js/4.097d3106.js"><link rel="prefetch" href="/assets/js/5.d4f984a3.js"><link rel="prefetch" href="/assets/js/6.600b4633.js"><link rel="prefetch" href="/assets/js/7.42b765bd.js"><link rel="prefetch" href="/assets/js/8.e35849ac.js"><link rel="prefetch" href="/assets/js/9.dd5ecd94.js">
    <link rel="stylesheet" href="/assets/css/0.styles.992cb7aa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">lishenjian | Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Vue/" class="nav-link">
  Vue 笔记
</a></div><div class="nav-item"><a href="/JavaScript/" class="nav-link">
  JavaScrip
</a></div><div class="nav-item"><a href="/Monitor/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  前端监控
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Vue/" class="nav-link">
  Vue 笔记
</a></div><div class="nav-item"><a href="/JavaScript/" class="nav-link">
  JavaScrip
</a></div><div class="nav-item"><a href="/Monitor/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  前端监控
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Monitor/" aria-current="page" class="active sidebar-link">前端监控</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Monitor/#前端监控目标" class="sidebar-link">前端监控目标</a></li><li class="sidebar-sub-header"><a href="/Monitor/#前端监控流程" class="sidebar-link">前端监控流程</a></li><li class="sidebar-sub-header"><a href="/Monitor/#监控-sdk" class="sidebar-link">监控 sdk</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端监控"><a href="#前端监控" class="header-anchor">#</a> 前端监控</h1> <h2 id="前端监控目标"><a href="#前端监控目标" class="header-anchor">#</a> 前端监控目标</h2> <h3 id="稳定性"><a href="#稳定性" class="header-anchor">#</a> 稳定性</h3> <ul><li>js 错误（未捕获的错误）
<blockquote><p>JS执行错误或者 promise 异常</p></blockquote></li> <li>资源异常
<blockquote><p>script、link等资源加载异常</p></blockquote></li> <li>接口错误
<blockquote><p>ajax或fetch请求接口异常</p></blockquote></li> <li>白瓶
<blockquote><p>页面空白</p></blockquote></li></ul> <h3 id="用户体验"><a href="#用户体验" class="header-anchor">#</a> 用户体验</h3> <p>指各个阶段的加载时间</p> <ul><li>TTFB（time to first byte）首字节时间
<blockquote><p>指浏览器发起第一个请求到数据返回第一个字节所消耗的时间，这个时间包含了网络请求时间、后端处理时间</p></blockquote></li> <li>FP（First paint）首次绘制时间
<blockquote><p>首次绘制包含了任何用户自定义的背景绘制，它是将第一个像素点绘制到屏幕的时间</p></blockquote></li> <li>FCP（First content paint）首次内容绘制
<blockquote><p>首次内容绘制是浏览器将第一个DOM渲染到屏幕的时间，可以是任何文本、图像、SVG等的时间</p></blockquote></li> <li>FMP（First Meaningful Paint）首次有意义绘制
<blockquote><p>首次有意义绘制是页面可用性的量度标准</p></blockquote></li> <li>FID（First inlut delay）首次输入延迟</li></ul> <blockquote><p>用户首次和页面交互到页面响应交互的时间</p></blockquote> <ul><li>卡顿
<blockquote><p>超过50ms 的长任务</p></blockquote></li></ul> <h3 id="业务"><a href="#业务" class="header-anchor">#</a> 业务</h3> <ul><li>PV  Page View 即页面浏览量或点击量</li> <li>UV  指访问某个站点的不同IP地址的人数</li> <li>页面的停留时间</li></ul> <h2 id="前端监控流程"><a href="#前端监控流程" class="header-anchor">#</a> 前端监控流程</h2> <ul><li>前端埋点</li> <li>数据上报</li> <li>分析和计算 将采集到的数据进行加工汇总</li> <li>可视化展示 将数据按各种维度进行展示</li> <li>监控报警 发现问题后按一定的条件出发报警</li></ul> <h3 id="常见的埋点方案"><a href="#常见的埋点方案" class="header-anchor">#</a> 常见的埋点方案</h3> <h4 id="代码埋点"><a href="#代码埋点" class="header-anchor">#</a> 代码埋点</h4> <ul><li>以嵌入代码的形式进行埋点，比如需要监控用户的点击事件，会选择在用户点击时插入一段代码，保存这个监听行为或者直接将监听行为以某一种数据格式直接传给服务器端。</li> <li>优点是可以在任意时刻，精确的发送或保存所需要的数据信息</li> <li>缺点是工作量大</li></ul> <h4 id="可视化埋点"><a href="#可视化埋点" class="header-anchor">#</a> 可视化埋点</h4> <ul><li>通过可视化交互的手段，代替代码埋点</li> <li>将业务代码和埋点代码分离，提供一个可视化的交互页面，输入为业务代码，通过这个可视化的系统，可以在业务代码中自定义增加埋点事件等等，最后输出的代码耦合了业务代码和埋点代码</li> <li>可视化埋点其实是用系统来代替手工插入埋点代码</li></ul> <h4 id="无痕埋点"><a href="#无痕埋点" class="header-anchor">#</a> 无痕埋点</h4> <ul><li>前端的任意一个事件都被绑定一个标识，所有的事件都被记录下来</li> <li>通过定期上传记录文件，配合文件解析，解析出来我们想要的数据，并生成可视化报告供专业人员分析</li> <li>无痕埋点的优势是采集全量数据，不会出现漏埋和误埋等现象</li> <li>缺点是给数据传输和服务器增加压力，也无法灵活定制数据结构</li></ul> <h2 id="监控-sdk"><a href="#监控-sdk" class="header-anchor">#</a> 监控 sdk</h2> <blockquote><p>user-agent npm 包 是用作把浏览器的UserAgent变成一个对象
webpack 5* + webpack-cli 4*   webpack-dev-server 配置 webpack serve 启动命令</p></blockquote> <h3 id="错误分类"><a href="#错误分类" class="header-anchor">#</a> 错误分类</h3> <ul><li>js 错误</li> <li>promise 异常</li> <li>资源异常</li></ul> <h3 id="异常错误-数据结构"><a href="#异常错误-数据结构" class="header-anchor">#</a> 异常错误 数据结构</h3> <ul><li>jsError</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;前端监控系统&quot;</span><span class="token punctuation">,</span>            <span class="token comment">//页面标题</span>
  <span class="token string">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/&quot;</span><span class="token punctuation">,</span>    <span class="token comment">//页面url</span>
  <span class="token string">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                    <span class="token comment">//访问时间戳</span>
  <span class="token string">&quot;userAtgent&quot;</span><span class="token operator">:</span> <span class="token string">&quot;chrome&quot;</span><span class="token punctuation">,</span>             <span class="token comment">//用户浏览器类型</span>
  <span class="token string">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stability&quot;</span><span class="token punctuation">,</span>                <span class="token comment">//大类</span>
  <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>                    <span class="token comment">//小类</span>
  <span class="token string">&quot;errorType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jsError&quot;</span><span class="token punctuation">,</span>             <span class="token comment">//错误类型</span>
  <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                      <span class="token comment">//类型详情</span>
  <span class="token string">&quot;filename&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                     <span class="token comment">//访问的文件名</span>
  <span class="token string">&quot;position&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0:0&quot;</span><span class="token punctuation">,</span>                  <span class="token comment">//行列信息</span>
  <span class="token string">&quot;stack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                        <span class="token comment">//堆栈信息</span>
  <span class="token string">&quot;selector&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>                      <span class="token comment">//选择器</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>promiseError</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;前端监控系统&quot;</span><span class="token punctuation">,</span>            <span class="token comment">//页面标题</span>
  <span class="token string">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/&quot;</span><span class="token punctuation">,</span>    <span class="token comment">//页面url</span>
  <span class="token string">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                    <span class="token comment">//访问时间戳</span>
  <span class="token string">&quot;userAtgent&quot;</span><span class="token operator">:</span> <span class="token string">&quot;chrome&quot;</span><span class="token punctuation">,</span>             <span class="token comment">//用户浏览器类型</span>
  <span class="token string">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stability&quot;</span><span class="token punctuation">,</span>                <span class="token comment">//大类</span>
  <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>                    <span class="token comment">//小类</span>
  <span class="token string">&quot;errorType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;promiseError&quot;</span><span class="token punctuation">,</span>        <span class="token comment">//错误类型</span>
  <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                      <span class="token comment">//类型详情</span>
  <span class="token string">&quot;filename&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                     <span class="token comment">//访问的文件名</span>
  <span class="token string">&quot;position&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0:0&quot;</span><span class="token punctuation">,</span>                  <span class="token comment">//行列信息</span>
  <span class="token string">&quot;stack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                        <span class="token comment">//堆栈信息</span>
  <span class="token string">&quot;selector&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>                      <span class="token comment">//选择器</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8ad917e5.js" defer></script><script src="/assets/js/2.eeada228.js" defer></script><script src="/assets/js/10.8a4cc5a5.js" defer></script>
  </body>
</html>
